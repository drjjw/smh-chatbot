# UKidney Manual Assistant - Proxy to Node.js
RewriteEngine On

# Don't proxy if directly accessing these (would create loops)
RewriteCond %{REQUEST_URI} !^/\.well-known/

# Proxy everything to Node.js on port 3456
RewriteRule ^(.*)$ http://127.0.0.1:3456/$1 [P,L,QSA]

# CORS Headers
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
</IfModule>

# Security
<FilesMatch "^(\.env|server\.js|package.*|\.git)">
    Require all denied
</FilesMatch>
